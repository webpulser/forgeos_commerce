- unless defined?(level)
  - level = 0
- categories.each do |category|
  %li{ :rel => category.children.empty? ? 'file' : 'folder', :id => "category_#{category.id}" }
    - picture = category.attachments.find_all_by_type('Picture').first
    = link_to category.name, '#', :style => (picture ? "background-image : url('#{picture.public_filename(:icon)}');" : '')
    = "<ul>" unless category.children.empty?
    - category.children.each do |child|
      = render :partial => 'admin/categories/list', :locals => { :categories => [child], :level => (level + 1) }
    = "</ul>" unless category.children.empty?
