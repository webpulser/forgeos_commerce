<h1>Show Picture</h1>
<% @content_for_tools << link_to('back', :back) %>
<p>
  <b>Filename :</b>
  <%= @picture.filename %>
</p>

<p>
  <b>Content Type:</b>
  <%= @picture.content_type %>
</p>

<% thumbnail_names = %w[big normal small thumb] #@picture.attachment_options[:thumbnails].keys %>
<fieldset>
  <legend><%= link_to_effect_toggle('Thumbnails','thumbnails',:toggle_slide) %></legend>
  <table id="thumbnails">
    <% thumbnail_names.each do |thumb| %>
    <tr>
    <td>
      <%= image_tag @picture.public_filename(thumb) %>
    </td>
    <td><%= thumb %></td>
    </tr>
    <% end %>
  </table>
</fieldset>

<fieldset>
  <legend><%= link_to_effect_toggle('Associated Elements','associated_elements') %></legend>
  <ul class="no-list-style-type" id="associated_elements">
    <% products = @picture.sortable_pictures.collect{ |sp| sp.picturable if sp.picturable.kind_of?(Product)}.compact
    unless products && products.empty?%>
      <li>
        <h3><%= 'Products :' %></h3>
        <ul class="no-list-style-type">
        <% products.each do |product| %>
          <li><%= link_to(product.name, :controller => 'products', :action => 'edit', :id => product.id) %></li>
        <% end %>
        </ul>
      </li>
    <% end %>

    <% attributes_groups = @picture.sortable_pictures.collect{ |sp| sp.picturable if sp.picturable.kind_of?(AttributesGroup)}.compact
    unless attributes_groups && attributes_groups.empty? %>
      <li>
        <h3><%= 'Attributes Groups :' %></h3>
        <ul class="no-list-style-type">
        <% attributes_groups.each do |attributes_group| %>
          <li><%= link_to(attributes_group.name, :controller => 'attributes_groups', :action => 'edit', :id => attributes_group.id) %></li>
        <% end %>
        </ul>
      </li>
    <% end %>

    <% tattributes = @picture.sortable_pictures.collect{ |sp| sp.picturable if sp.picturable.kind_of?(Attribute)}.compact
    unless tattributes && tattributes.empty? %>
      <li>
        <h3><%= 'Attributes :' %></h3>
        <ul class="no-list-style-type">
        <% tattributes.each do |tattribute| %>
          <li><%= link_to(tattribute.name, :controller => 'attributes_groups', :action => 'edit_attribute', :id => tattribute.id) %></li>
        <% end %>
        </ul>
      </li>
    <% end %>
    <% categories = @picture.sortable_pictures.collect{ |sp| sp.picturable if sp.picturable.kind_of?(Category)}.compact
    unless categories && categories.empty? %>
      <li>
        <h3><%= 'Categories :' %></h3>
        <ul class="no-list-style-type">
        <% categories.each do |category| %>
          <li><%= link_to(category.name, :controller => 'categories', :action => 'edit', :id => category.id) %></li>
        <% end %>
        </ul>
      </li>
    <% end %>
</fieldset>

<fieldset>
  <legend>
    <%= link_to_effect_toggle('Comments','comments') %> |
    <%= link_to_remote 'create a comment', 
    :url => { :controller => 'pictures', :action => 'create_comment', :id => @picture.id },
    :update => 'comment_add', :method => 'get', :complete => "$('comments').show()" %>
  </legend>
  <div id="comments">
    <%= render :partial => 'list_comments', :locals => { :comments => @picture.comments } %>
  </div>
</fieldset>
<%= hide_html_elements_onload %w[comments thumbnails associated_elements] %>
