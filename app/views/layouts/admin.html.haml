!!!
- menu = YAML.load_file(File.join(RAILS_ROOT, 'config', 'admin_menu.yml' ))
%html{ :xmlns => "http://www.w3.org/1999/xhtml" }
  %head
    %meta{ :content => "text/html; charset=utf-8", "http-equiv" => "Content-Type" }
    %title
      = t 'project_name'
      \- Admin
    %link{ :href => "/favicon.ico", :rel => "shortcut icon", :type => "image/x-icon" }
    = stylesheet_link_tag 'admin/droppy', 'admin/style', 'admin/theme'+(cookies[:theme]||''), 'dataTables/demo_page', 'dataTables/demo_table'
    = javascript_include_tag(:defaults, 'jquery.droppy', 'jquery.dataTables.min', 'jquery.cookies.min', :cache => false)
    /
      [if IE]>
      <haml:loud> stylesheet_link_tag '/stylesheets/admin/ie-sucks' </haml:loud>
      <![endif]
  %body
    #container
      #header
        %h2
          = I18n.t 'project_name'
          \- Admin
        .logged_in
          - if logged_in?
            = link_to current_user.fullname, admin_account_path(current_user), :title => I18n.t('your_account').capitalize
            |
            = link_to I18n.t('disconnect').capitalize, admin_session_path(:locale => params[:locale]), :method => :delete
          - else
            = link_to I18n.t('log_in').capitalize, new_admin_session_path(:locale => params[:locale])
        %div
          \&nbsp;
        .change_language
          - I18n.available_locales.each do |key, locale|
            = link_to_unless(I18n.locale.to_sym==key.to_sym, image_tag("flags/#{key}.gif"), :locale => key)
        #topmenu
          %ul#nav
            - menu.each_key do |entry|
              %li{ :class => (@controller.controller_name == entry || menu[entry].keys.include?(@controller.controller_name)) ? 'current' : nil }
                = link_to(I18n.t(entry).capitalize, { :controller => entry } , :class => 'folder_table')
                %ul
                  - menu[entry].each_key do |subentry|
                    %li
                      = link_to(I18n.t(subentry).capitalize, { :controller => (menu[entry][subentry]['class'].nil? ? subentry : entry), :action => (menu[entry][subentry]['class'].nil? ? 'index' : subentry), :id => menu[entry][subentry]['id'] } , :class => menu[entry][subentry]['class'] || 'folder_table')
          
        = javascript_tag "$('#nav').droppy({speed: 5, timeout: 5})"
      #top-panel
        #panel
          #display_standard_flashes
            = display_standard_flashes
          %ul
            = yield_for_tools
      #wrapper
        #content
          = yield
      #footer
        #credits
          = t 'template_by'
          %a{ :href => "http://www.bloganje.com" }
            Bloganje
        #styleswitcher
          %ul
            %li
              = link_to_function 'd', "$.cookies.set('theme', null); window.location.reload()", :title=>I18n.t('default'), :id=>'defswitch'
            %li
              = link_to_function 'b', "$.cookies.set('theme', 1); window.location.reload()", :title=>I18n.t('blue'), :id=>'blueswitch'
            %li
              = link_to_function 'g', "$.cookies.set('theme',2); window.location.reload()", :title=>I18n.t('green'), :id=>'greenswitch'
            %li
              = link_to_function 'br', "$.cookies.set('theme',3); window.location.reload()", :title=>I18n.t('brown'), :id=>'brownswitch'
            %li
              = link_to_function 'm', "$.cookies.set('theme',4); window.location.reload()", :title=>I18n.t('mix'), :id=>'mixswitch'
        %br
